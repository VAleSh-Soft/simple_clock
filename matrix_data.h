#pragma once

#include <avr/pgmspace.h>

// цифры 6x8
const uint8_t PROGMEM font_digit[] = {
    0x7E, 0x85, 0x89, 0x91, 0xA1, 0x7E, // 0
    0x00, 0x00, 0x41, 0xFF, 0x01, 0x00, // 1
    0x43, 0x85, 0x89, 0x89, 0x89, 0x73, // 2
    0x42, 0x81, 0x91, 0x91, 0x91, 0x6E, // 3
    0x0C, 0x14, 0x24, 0x44, 0x84, 0xFF, // 4
    0xF2, 0xA1, 0xA1, 0xA1, 0xA1, 0x9E, // 5
    0x7E, 0x91, 0x91, 0x91, 0x91, 0x4E, // 6
    0xC0, 0x80, 0x87, 0x88, 0x90, 0xE0, // 7
    0x6E, 0x91, 0x91, 0x91, 0x91, 0x6E, // 8
    0x72, 0x89, 0x89, 0x89, 0x89, 0x7E, // 9
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // space
    0x00, 0x08, 0x08, 0x08, 0x08, 0x08, // -
    0x00, 0x08, 0x08, 0x3E, 0x08, 0x08, // +
    0xA0, 0x40, 0x1E, 0x21, 0x21, 0x12, // grad
    0x7F, 0x88, 0x88, 0x88, 0x88, 0x7F, // A
    0xFF, 0x01, 0x01, 0x01, 0x01, 0x03, // L
    0x11, 0x0A, 0x04, 0x0A, 0x11, 0x00, // x
    0x04, 0x02, 0x01, 0x06, 0x18, 0x20, // √
    0xFE, 0x09, 0x11, 0x11, 0x11, 0x0E  // b
};

// 
/**
 * @brief Определение дня недели по дате в интервале 2000-2099 года, 0 - воскресенье
 * 
 * @param _day дата 
 * @param _month месяц
 * @param _year год
 * @return номер дня недели, начиная с нуля (воскресенье) 
 */
uint8_t getDayOfWeek(uint8_t _day, uint8_t _month, uint16_t _year)
{
  const uint8_t PROGMEM m[12] = {6, 2, 2, 5, 0, 3, 5, 1, 4, 6, 2, 4};

  uint8_t y1 = _year % 2000;
  // вычислить индекс года
  uint8_t t1 = y1 / 12 + y1 % 12 + y1 % 12 / 4;
  // получить индекс месяца
  uint8_t t2 = pgm_read_byte(&m[_month - 1]);
  // сделать поправку на високосный год, если нужно
  if (_month < 3 && t1 % 4 == 0)
  {
    t2--;
  }

  return ((t1 + t2 + _day) % 7);
}