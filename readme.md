# simple_clock v1.1.3
Простые часы на модуле **DS3231** и семисегментном индикаторе с драйвером **TM1637**. Календаря нет. В базовом варианте (без будильника) помещается в **ATmega8**/**ATmega88**, но проверить работу на этих контроллерах возможности не было.

Часы управляются тремя кнопками: **Set** - вход в режим настроек и сохранение изменений; **Up** - увеличение текущих значений; **Down** - уменьшение текущих значений.

Вход в настройки текущего времени выполняется длинным кликом кнопкой **Set**.

## Дополнительные возможности

### Будильник

Для использования будильника нужно раскомментировать строку `#define USE_ALARM` в файле **header_file.h**.

Состояние будильника показывает светодиод - если будильник включен, светодиод светится, если будильник сработал, светодиод мигает.

Сигнал сработавшего будильника отключается кликом любой кнопки.

В режим настройки будильника по умолчанию можно перейти по двойному клику кнопкой **Set**. Или можно настроить переход в этот режим по одиночному клику кнопкой **Set**, для этого нужно раскомментировать строку `#define USE_ONECLICK_TO_SET_ALARM` в файле **header_file.h**. Включение/выключение будильника выполняется кнопками **Up** или **Down**. После включения будильника следующий клик кнопкой **Set** переводит в режим настройки времени его срабатывания.

### Автоматическое управление яркостью экрана

Предусмотрена возможность снижения яркости экрана при низком освещении по данным датчика света - фоторезистора типа **GL5528**, подключенного к пину **A3**. Для этого нужно раскомментировать строку `#define USE_LIGHT_SENSOR` в файле **header_file.h**.

Схема подключения датчика: `GND -> R(10k) -> A3 <- Rl <- VCC`, где **R** - резистор 10кОм, **Rl** - фоторезистор. 

Если использование датчика света не предполагается, индикатор всегда будет работать с максимальной (т.е. заданной в строке `#define MAX_DISPLAY_BRIGHTNESS 7`) яркостью. 

### Вывод на экран текущей температуры

Для вывода на экран текущей температуры нужно раскомментировать строку `#define USE_TEMP_DATA` в файле **header_file.h**. В этом случае в режиме отображения текущего времени клик кнопкой **Up** будет выводить на несколько секунд температуру окружающей среды.

Температура по умолчанию берется из внутреннего датчика микросхемы **DS3231**, однако есть возможность использования внешнего датчика **DS18b20**. Для этого нужно раскомментировать строку `#define USE_DS18B20` в файле **header_file.h**.

Кроме датчика **DS18b20** можно использовать датчики **DS18s20**, **DS1820**, **DS1822**.

### Подключение модулей

Часы построены с использованием модуля **DS3231**, семисегментного экрана  с драйвером **TM1637** и **Arduino Pro Mini** на базе **ATmega168p**. В качестве источника звука использован пассивный пьезоэлектрический излучатель.

Пины для подключения экрана, кнопок, пищалки, светодиода и датчиков температуры и света определены в файле **header_file.h**

Модуль **DS3231** подключен к пинам **A4** (**SDA**) и **A5** (**SCL**)

### Использованные сторонние библиотеки

**shButton.h** - https://github.com/VAleSh-Soft/shButton <br>
**shTaskManager.h** - https://github.com/VAleSh-Soft/shTaskManager <br>
**DS3231.h** - https://github.com/NorthernWidget/DS3231 <br>
**TM1637Display.h** - https://github.com/avishorp/TM1637 <br>

для работы с датчиком DS18b20 используется библиотека


**OneWire.h** - https://github.com/PaulStoffregen/OneWire


Если возникнут вопросы, пишите на valesh-soft@yandex.ru 